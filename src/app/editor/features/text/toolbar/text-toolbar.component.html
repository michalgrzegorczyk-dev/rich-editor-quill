<div [style.left.px]="getLeftPosition()"
     [style.top.px]="getTopPosition()"
     class="floating-toolbar ql-toolbar ql-snow">

  <span class="ql-formats">
    <select (change)="handleHeaderChange($event)" [value]="getCurrentHeader()" class="ql-header">
      <option value="1">Heading 1</option>
      <option value="2">Heading 2</option>
      <option selected>Normal</option>
    </select>
  </span>

  <div class="toolbar-divider"></div>

  <span class="ql-formats">
    <button (click)="toggleFormat('bullet')" [class.active]="getListType() === 'bullet'" class="ql-list">
      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <line x1="8" y1="6" x2="21" y2="6"></line>
        <line x1="8" y1="12" x2="21" y2="12"></line>
        <line x1="8" y1="18" x2="21" y2="18"></line>
        <circle cx="3" cy="6" r="1"></circle>
        <circle cx="3" cy="12" r="1"></circle>
        <circle cx="3" cy="18" r="1"></circle>
      </svg>
    </button>
    <button (click)="toggleFormat('ordered')" [class.active]="getListType() === 'ordered'" class="ql-list">
      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <line x1="10" y1="6" x2="21" y2="6"></line>
        <line x1="10" y1="12" x2="21" y2="12"></line>
        <line x1="10" y1="18" x2="21" y2="18"></line>
        <text x="2" y="7" font-size="8">1</text>
        <text x="2" y="13" font-size="8">2</text>
        <text x="2" y="19" font-size="8">3</text>
      </svg>
    </button>
  </span>

  <div class="toolbar-divider"></div>

  <span class="ql-formats">
    <button (click)="toggleFormat('bold')" [class.active]="isFormatActive('bold')" class="ql-bold">
      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M6 4h8a4 4 0 0 1 4 4 4 4 0 0 1-4 4H6z"></path>
        <path d="M6 12h9a4 4 0 0 1 4 4 4 4 0 0 1-4 4H6z"></path>
      </svg>
    </button>
    <button (click)="toggleFormat('italic')" [class.active]="isFormatActive('italic')" class="ql-italic">
      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <line x1="19" y1="4" x2="10" y2="4"></line>
        <line x1="14" y1="20" x2="5" y2="20"></line>
        <line x1="15" y1="4" x2="9" y2="20"></line>
      </svg>
    </button>
    <button (click)="toggleFormat('underline')" [class.active]="isFormatActive('underline')" class="ql-underline">
      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M6 3v7a6 6 0 0 0 6 6 6 6 0 0 0 6-6V3"></path>
        <line x1="4" y1="21" x2="20" y2="21"></line>
      </svg>
    </button>
    <button (click)="toggleFormat('code')" [class.active]="isFormatActive('code')" class="ql-code">
      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <polyline points="16 18 22 12 16 6"></polyline>
        <polyline points="8 6 2 12 8 18"></polyline>
      </svg>
    </button>
  </span>

  <div class="toolbar-divider"></div>

  <span class="ql-formats">
    <button (click)="toggleColorPicker()" [class.active]="showColorPicker" class="ql-color" [style.background-color]="getCurrentColor() === 'black' ? 'white' : getCurrentColor()">
      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M9 3h6l3 7H6z"/>
        <path d="M12 10v8"/>
        <path d="M6 21h12"/>
      </svg>
    </button>

    <button (click)="toggleBgColorPicker()" [class.active]="showBgColorPicker" class="ql-background" [style.background-color]="getCurrentBgColor()">
      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <rect x="2" y="2" width="20" height="20" rx="2"/>
        <rect x="6" y="6" width="12" height="12" rx="1"/>
      </svg>
    </button>
  </span>

  <div class="toolbar-divider"></div>

  <span class="ql-formats">
    <button (click)="resetFormatting()" class="ql-reset">
      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <line x1="18" y1="6" x2="6" y2="18"></line>
        <line x1="6" y1="6" x2="18" y2="18"></line>
      </svg>
    </button>
  </span>

  <div *ngIf="showColorPicker" class="color-picker-popup">
    <div class="color-options">
      <button *ngFor="let color of colors"
              [style.background-color]="color"
              (click)="applyColor(color)"
              class="color-option"
              [class.selected]="color === activeColor">
      </button>
    </div>
  </div>

  <div *ngIf="showBgColorPicker" class="color-picker-popup background-picker">
    <div class="color-options">
      <button *ngFor="let color of bgColors"
              [style.background-color]="color"
              (click)="applyBgColor(color)"
              class="color-option"
              [class.selected]="color === activeBgColor">
      </button>
    </div>
  </div>
</div>
